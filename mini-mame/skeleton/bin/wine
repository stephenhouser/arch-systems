#!/usr/bin/env python3
# Start wine game...

import sys
import os
import csv

GAMES_FILE = os.path.expanduser("~/.config/wine/wine.cfg")

if len(sys.argv) != 2:
    print("ERROR: Requires a game name")
    sys.exit()


game_name = sys.argv[1]
executable = None
with open(GAMES_FILE) as csvfile:
    # (Name, Title, Emulator;Executable)
    gamereader = csv.DictReader(csvfile, delimiter=';')
    for game in gamereader:
        if game['Name'] == game_name:
            prefix = os.path.expanduser(game['Prefix'])
            exe = os.path.join(prefix, game['Executable'])
            os.system(f"WINEPREFIX={prefix} /usr/bin/wine '{exe}'")

print(f"Game {game_name} not found.")
